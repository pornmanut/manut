---
import BaseLayout from '../../layouts/BaseLayout.astro';
import Header from '../../components/money/Header.astro';
import DataManagement from '../../components/money/DataManagement.astro';
import Dashboard from '../../components/money/Dashboard.astro';
import TransactionManagement from '../../components/money/TransactionManagement.astro';
import CategoryModal from '../../components/money/CategoryModal.astro';
---

<BaseLayout title="Money Manager - Manut.dev" description="Track your income and expenses with this simple money management tool">
  <div class="space-y-8">
    <Header />
    
    <DataManagement />
    
    <Dashboard />
    
    <TransactionManagement />
    
    <CategoryModal />
  </div>
</BaseLayout>

<!-- Load all the modular TypeScript scripts -->
<script src="../../scripts/money-manager.ts"></script>
<script src="../../scripts/money/ui-controller.ts"></script>
<script src="../../scripts/money/notification-system.ts"></script>
<script src="../../scripts/money/transaction-controller.ts"></script>
<script src="../../scripts/money/dashboard-renderer.ts"></script>
<script src="../../scripts/money/category-manager.ts"></script>
<script src="../../scripts/money/file-operations.ts"></script>
<script src="../../scripts/money/app-controller.ts"></script>

<script is:inline>
  // Initialize the application when all scripts are loaded
  document.addEventListener('DOMContentLoaded', () => {
    // Wait for all modules to be available
    function initializeApp() {
      if (typeof AppController !== 'undefined') {
        try {
          const app = new AppController();
          app.initialize();
        } catch (error) {
          console.error('Error initializing AppController:', error);
        }
      } else {
        // Retry after a short delay if not loaded yet
        setTimeout(initializeApp, 100);
      }
    }
    
    initializeApp();
  });
</script>
